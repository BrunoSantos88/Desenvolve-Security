Vagrant.configure("2") do |config|
    config.vm.box = "kalilinux/rolling"  # Change to Kali Linux box
  
    config.vm.provider "virtualbox" do |vb|
      vb.memory = "4096" # Allocate 4GB of memory
    end
  
    config.vm.network "public_network", bridge: "TP-Link Wireless USB Adapter", ip: "192.168.15.6"
    config.vm.network "forwarded_port", guest: 22, host: 2222, id: "ssh"
    config.vm.network "forwarded_port", guest: 3389, host: 3389, id: "rdp"
  
    config.vm.provision "shell", inline: <<-SHELL
      echo 'PasswordAuthentication yes' | sudo tee -a /etc/ssh/sshd_config
      sudo systemctl restart sshd
  
      # Installation of necessary packages for RDP
      sudo apt update
      sudo apt install -y xrdp xfce4
      sudo systemctl enable xrdp
  
      # Allow RDP traffic through the firewall
      sudo ufw allow 3389/tcp
  
      # Add public key for the 'vagrant' user
      mkdir -p /home/vagrant/.ssh
      echo "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQCsWY5onamLJt1f3ZvVguYsgdY5NEPEvucHXuyFqIyP88qfhqPfrl5c/WNgMyG468II/lj+5Pm4KhTCV96py51M+RvpzTVHzfliwxvEBfa6nlmP28jfUotNzgQnbNavtO5zmk/MwjDgJJpKe9OeXbnzPm//LdRlhfG64pvmJpBhGLb2/gld0ygxbrgDszmcB2vX0uvyJ3h6NcAyl+KtowQZrCSKK++ESJr3BNgn+0vPhViG2ojYq+oUtR4ZSetpZRK3lSETVS68L1Idhnp0LscuWt3Wd38rX1hT7NOnfUe7cAs8ixXw/3coJyfsYVRx8TGY7haTxL76np6dynj2JeojfnIdrZOpTqFAiHXtvEIe7f4DNjoMZlmnuqEwchYkSlH1gTn/RZOtHgeDmWgmXmg7onyT08eJnn3X6eTCt8k2L7m2ZHQX0P5R1MDCSOcqaRbcjKpVEDGHJmIMSECE2IkZb8VIXKwvyjwlZKSKi06GiA9Gl4JlQyhEYbln7MdaMoD118up7s+yZiHWQgON0P9v74pt1B6iEodTdeiJoRA08mbw0N1hVenvwoGYGHRZamJmj7m43lDXEOWPooUpmifI8WRxTeRuTyKqtKMIzNZbnzRexr0emga19s8JrJDBBOGh9PHYVI/BFZ5RZF7+RpgCtJ8o1fr4/LmsNEySzlj8kw== brunosantosc1@gmail.com" >> /home/vagrant/.ssh/authorized_keys
      chown -R vagrant:vagrant /home/vagrant/.ssh
      chmod 700 /home/vagrant/.ssh
      chmod 600 /home/vagrant/.ssh/authorized_keys
    SHELL
  
    config.ssh.insert_key = false
  end